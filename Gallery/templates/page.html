<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>GalerÃ­a Catbox Mejorada</title>
  <link rel="stylesheet" href="data/style.css">
</head>
<body>

  <h1>ğŸ“¦ GalerÃ­a de Catbox.moe Mejorada</h1>

  <p style="text-align:center;">
    <a href="http://localhost:8000/" style="color: #0077cc; text-decoration: none;">ğŸ”™ Volver al directorio raÃ­z</a>
  </p>

  <div class="section-title">ğŸ–¼ï¸ ImÃ¡genes</div>
  <div class="media-container" id="imagesContainer"></div>

  <div class="section-title">ğŸ¥ Videos</div>
  <div class="media-container" id="videosContainer"></div>

  <!-- Modal para vista ampliada -->
  <div id="modal">
    <div id="closeModal">âœ–</div>
    <div id="modalContent"></div>
  </div>

  <script>
    const imgContainer = document.getElementById('imagesContainer');
    const videoContainer = document.getElementById('videosContainer');
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modalContent');
    const closeModal = document.getElementById('closeModal');

    function createItem(tag, src, controls = false) {
      const wrapper = document.createElement('div');
      wrapper.className = 'item';

      const media = document.createElement(tag);
      media.src = src;
      if (controls) media.setAttribute('controls', true);

      if (tag === 'img' || tag === 'video') {
        wrapper.addEventListener('click', () => {
          modalContent.innerHTML = '';
          const clone = media.cloneNode(true);
          modalContent.appendChild(clone);
          modal.style.display = 'flex';
        });
      }

      wrapper.appendChild(media);
      return wrapper;
    }

    fetch('data/data.json')
      .then(response => response.json())
      .then(links => {
        links.forEach(url => {
          const ext = url.split('.').pop().toLowerCase();

          if (['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(ext)) {
            imgContainer.appendChild(createItem('img', url));
          } else if (['mp4', 'webm', 'ogg'].includes(ext)) {
            videoContainer.appendChild(createItem('video', url, true));
          }
        });
      })
      .catch(error => {
        console.error("Error cargando data.json:", error);
      });

    closeModal.addEventListener('click', () => {
      modal.style.display = 'none';
      modalContent.innerHTML = '';
    });

    window.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
        modalContent.innerHTML = '';
      }
    });
  </script>

</body>
</html>